<!DOCTYPE html>
<html style="height: 100%">
   <head>
       <meta charset="utf-8">
       <title>Line Chart</title>
   </head>
   <body style="height: 100%; margin: 0">
       <div id="container" style="height: 100%"></div>
       <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts-all-3.js"></script>
       <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
       <script type="text/javascript">
           var dom = document.getElementById("container");
           var myChart = echarts.init(dom);
           var app = {};
           $.get('dataset.json').done(function (data) {
                var targetData = data.filter(function (n) {
                    //Name obtained from search box
                    return n.name === 'JACK';
                });
                //Arrays to store information for different regions
                var engData = targetData.filter(function (n) {
                    return n.country ==='England';
                });
                var scoData = targetData.filter(function (n) {
                    return n.country ==='Scotland';
                });
                var walData = targetData.filter(function (n) {
                    return n.country ==='Wales';
                });
                var ireData = targetData.filter(function (n) {
                    return n.country ==='Northern Ireland';
                });
                //Arrays to store ranks for different regions
                var engRank = [null, null, null, null, null, null], 
                    scoRank = [null, null, null, null, null, null], 
                    walRank = [null, null, null, null, null, null], 
                    ireRank = [null, null, null, null, null, null];
                //Arrays to store numbers of a name for different regions
                var engNumber = [0, 0, 0, 0, 0, 0],
                    scoNumber = [0, 0, 0, 0, 0, 0],
                    walNumber = [0, 0, 0, 0, 0, 0],
                    ireNumber = [0, 0, 0, 0, 0, 0];
                var allData = [engData, scoData, walData, ireData],
                    allRank = [engRank, scoRank, walRank, ireRank],
                    allNumber = [engNumber, scoNumber, walNumber, ireNumber];
                for(var i=0; i<4; i++) {
                    for(var j=0; j<allData[i].length; j++){
                        //Skip the years where the rank is absent, leave them null
                        allRank[i][allData[i][j].year - 2010] = allData[i][j].rank;
                        //Skip the years where the number is absent, leave them 0
                        allNumber[i][allData[i][j].year - 2010] = allData[i][j].count;
                    }
                }
               console.log(allNumber);
                //set option for the line chart
                myChart.setOption({
                title: {
                    text: 'The rank change from 2010 to 2015',
                    subtext: 'Jack'
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data:['England','Scotland','Wales','Northern Ireland']
                },
                calculable: true,
                xAxis:  {
                    type: 'category',
                    boundaryGap: false,
                    data: ['2010','2011','2012','2013','2014','2015'],
                    name: 'Year',
                    axisLine: {onZero: false}
                },
                yAxis: {
                    type: 'value',
                    name: 'Rank',
                    nameLocation: 'middle',
                    nameGap: 25,
                    inverse: true
                },
                series: [{
                    name:'England',
                    type:'line',
                    data:engRank,
                    markPoint: {
                        data: [
                            {type: 'max', name: 'Lowest rank'},
                            {type: 'min', name: 'Highest rank'}
                        ]
                    },
                    markLine: {
                        data: [
                            {type: 'average', name: 'Average rank'}
                        ]
                    }
                    },
                    {
                    name:'Scotland',
                    type:'line',
                    data:scoRank,
                    markPoint: {
                        data: [
                            {type: 'max', name: 'Lowest rank'},
                            {type: 'min', name: 'Highest rank'}
                        ]
                    },
                    markLine: {
                        data: [
                            {type: 'average', name: 'Average rank'}
                        ]
                    }
                    },
                    {
                    name:'Wales',
                    type:'line',
                    data:walRank,
                    markPoint: {
                        data: [
                            {type: 'max', name: 'Lowest rank'},
                            {type: 'min', name: 'Highest rank'}
                        ]
                    },
                    markLine: {
                        data: [
                            {type: 'average', name: 'Average rank'}
                        ]
                    }
                    },
                    {
                    name:'Northern Ireland',
                    type:'line',
                    data:ireRank,
                    markPoint: {
                        data: [
                            {type: 'max', name: 'Lowest rank'},
                            {type: 'min', name: 'Highest rank'}
                        ]
                    },
                    markLine: {
                        data: [
                            {type: 'average', name: 'Average rank'}
                        ]
                    }
                    }
                ]
            });
        });
            
            /*if (option && typeof option === "object") {
                myChart.setOption(option, true);
            }*/
       </script>
   </body>
</html>